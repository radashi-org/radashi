---
title: memo
description: Memoize a function
since: 12.1.0
---

### Usage

Wrap a function with memo to get a function back that automagically returns values that have already been calculated.

```ts
import * as _ from 'radashi'

const timestamp = _.memo(() => Date.now())

const now = timestamp()
const later = timestamp()

now === later // => true
```

### Expiration

You can optionally pass a `ttl` (time to live) that will expire memoized results. In versions prior to version 10, `ttl` had a value of 300 milliseconds if not specified.

```ts
import * as _ from 'radashi'

const timestamp = _.memo(() => Date.now(), {
  ttl: 1000, // milliseconds
})

const now = timestamp()
const later = timestamp()

await _.sleep(2000)

const muchLater = timestamp()

now === later // => true
now === muchLater // => false
```

### Key Function

You can optionally customize how values are stored when memoized.

```ts
const timestamp = _.memo(
  ({ group }: { group: string }) => {
    const ts = Date.now()
    return `${ts}::${group}`
  },
  {
    key: ({ group }: { group: string }) => group,
  },
)

const now = timestamp({ group: 'alpha' })
const later = timestamp({ group: 'alpha' })
const beta = timestamp({ group: 'beta' })

now === later // => true
beta === now // => false
```

You can optionally use a separate key for reading and writing cached values by providing a `setKey` function.
This allows for more flexible cache management and sharing of cached values between different function calls.

```ts
const func = _.memo(
  (arg: { id: string; withAdditionalStuff: boolean }) => {
    if (arg.withAdditionalStuff) {
      // do stuff
    }

    return arg.id
  },
  {
    key: arg =>
      arg.withAdditionalStuff
        ? `${arg.id}_withAdditionalStuff`
        : [`${arg.id}`, `${arg.id}_withAdditionalStuff`], // we also look for the shared key
    setKey: arg =>
      arg.withAdditionalStuff
        ? [`${arg.id}`, `${arg.id}_withAdditionalStuff`] // we also set the shared key
        : `${arg.id}`,
  },
)

func({ id: '1', withAdditionalStuff: true })
func({ id: '1', withAdditionalStuff: false })
// func is executed once
```
